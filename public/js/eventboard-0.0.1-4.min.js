
$(document).ready(function(){function t(e){window.EB.position=e.coords,r()}function n(e){log(arguments),window.EB.position=null}function r(){log("No location handlers implemented yet.")}log("Ready..."),window.EB={position:null,hasTouch:!0};var e=null;if(!("ontouchstart"in window)||window.DocumentTouch&&document instanceof DocumentTouch)document.documentElement.className="no-touch",window.EB.hasTouch=!1;navigator.geolocation?navigator.geolocation.getCurrentPosition(t,n):n("Not supported.");var i=$("#get-tweets-form"),s=$("#get-tweets-button");if(i.length){var o=function(t){s.attr("disabled",!0),i.find(".error").removeClass("error");var n=$("#tweet-query");return n.val().length?($("#tweet-lat").val(window.EB.position?window.EB.position.latitude:""),$("#tweet-lon").val(window.EB.position?window.EB.position.longitude:""),$.post("/twitter/fetch",i.serialize(),function(t){var n=typeof t=="string"?JSON.parse(t):t;log(n),i.find("input").val(""),s.removeAttr("disabled"),e.tweets(n)}),!1):(log("Bad query."),n.val("").addClass("error").focus(),s.removeAttr("disabled"),!1)};s.on("click",function(e){return o(e),e.preventDefault(),!1}),i.on("submit",function(e){return o(e),e.preventDefault(),!1})}var u=$("#get-instagrams-geo-form"),a=$("#get-instagrams-geo-button");if(u.length){var f=function(t){return a.attr("disabled",!0),u.find(".error").removeClass("error"),$("#instagram-lat").val(window.EB.position?window.EB.position.latitude:""),$("#instagram-lon").val(window.EB.position?window.EB.position.longitude:""),$.post("/instagram/fetch/geo",u.serialize(),function(t){var n=typeof t=="string"?JSON.parse(t):t;log(n),u.find("input").val(""),a.removeAttr("disabled"),e.instagramsGeo(n)}),!1};a.on("click",function(e){return f(e),e.preventDefault(),!1}),u.on("submit",function(e){return f(e),e.preventDefault(),!1})}var l=$("#get-instagrams-tags-form"),c=$("#get-instagrams-tags-button");if(l.length){var h=function(t){return c.attr("disabled",!0),l.find(".error").removeClass("error"),$.post("/instagram/fetch/tags",l.serialize(),function(t){var n=typeof t=="string"?JSON.parse(t):t;log(n),c.removeAttr("disabled"),e.instagramsTags(n,l.find("input").val()),l.find("input").val("")}),!1};c.on("click",function(e){return h(e),e.preventDefault(),!1}),l.on("submit",function(e){return h(e),e.preventDefault(),!1})}var p=function(){var e,t,n;return function(){$.get("/js/templates/tweets.handlebars",function(t){e=Handlebars.compile(t)}),$.get("/js/templates/instagrams-geo.handlebars",function(e){t=Handlebars.compile(e)}),$.get("/js/templates/instagrams-tags.handlebars",function(e){n=Handlebars.compile(e)})}(),{tweets:function(t){$("#tweet-results").html(e(t))},instagramsGeo:function(e){$("#instagram-geo-results").html(t(e))},instagramsTags:function(e,t){$("#instagram-tags-results").html(n(e)),$("#instagram-tags-results h2 span").html(t)}}};e=new p})